{
  "appInfo": {
    "appName": "",
    "appType": "console",
    "appDesc": "create console app.",
    "appID": ""
  },
  "nimble": [],
  "initVar": {
    "appDir": "{appsDir}::{appName}",
    "appSrcDir": "{appDir}::src"
  },
  "init": [
    {
      "action": "copyDir",
      "list": [
        {
          "src": "{templatesDir}::{appType}",
          "dest": "{appDir}"
        }
      ]
    },
    {
      "action": "copyFile",
      "list": [
        {
          "src": "nakefile.nim",
          "dest": "{appDir}::nakefile.nim"
        }
      ]
    }
  ],
  "var": {
    "srcDir": "{currentAppDir}::src",
    "binDir": "{currentAppDir}::bin",
    "debugBinDir": "{binDir}::debug",
    "releaseBinDir": "{binDir}::release",
    "nimbledepsDir": "{currentAppDir}::nimbledeps::pkgs"
  },
  "compile-debug": {
    "desc": "debug the app.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nim",
        "props": {
          "src": "{srcDir}::app.nim",
          "out": "{debugBinDir}"
        },
        "options": "c -d:nimDebugDlOpen --nimblePath:{nimbledepsDir} --outdir:{out} {src}"
      }
    ]
  },
  "debug-run": {
    "desc": "debug the app, then run it.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nake",
        "options": "debug {appName}",
        "next": [
          {
            "action": "cmd",
            "exe": "{debugBinDir}::app {appName} {appID}",
            "onPlatform": {
              "windows": {
                "exe": "start {debugBinDir}::app.exe {appName} {appID}"
              }
            }
          }
        ]
      }
    ]
  },
  "compile-release": {
    "desc": "release the app.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nim",
        "props": {
          "src": "{srcDir}::app.nim",
          "out": "{releaseBinDir}"
        },
        "options": "c -d:release --nimblePath:{nimbledepsDir} --outdir:{out} {src}"
      }
    ]
  },
  "release-run": {
    "desc": "release the app, then run it.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nake",
        "options": "release {appName}",
        "next": [
          {
            "action": "cmd",
            "exe": "{releaseBinDir}::app {appName} {appID}",
            "onPlatform": {
              "windows": {
                "exe": "start {releaseBinDir}::app.exe {appName} {appID}"
              }
            }
          }
        ]
      }
    ]
  },
  "watch-debug-run": {
    "desc": "watch changes in debug mode then run.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nake",
        "options": "debug {appName}",
        "next": [
          {
            "action": "cmd",
            "exe": "{debugBinDir}::app {appName} {appID} &",
            "onPlatform": {
              "windows": {
                "exe": "start {debugBinDir}::app.exe {appName} {appID}"
              }
            },
            "next": [
              {
                "action": "watch",
                "list": [
                  {
                    "dirs": [
                      "{srcDir}"
                    ],
                    "pattern": "(?=.*).+\\.nim$",
                    "events": [
                      {
                        "action": [
                          "onModified",
                          "onCreated"
                        ],
                        "list": [
                          {
                            "action": "cmd",
                            "exe": "killall app {appName} {appID}",
                            "onPlatform": {
                              "windows": {
                                "exe": "taskkill /IM \"app.exe {appName} {appID}\" /F"
                              }
                            }
                          },
                          {
                            "action": "cmd",
                            "exe": "nake",
                            "options": "compile-debug {appName}",
                            "next": [
                              {
                                "action": "cmd",
                                "exe": "{debugBinDir}::app {appName} {appID} &",
                                "onPlatform": {
                                  "windows": {
                                    "exe": "start {debugBinDir}::app.exe {appName} {appID}"
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "watch-release-run": {
    "desc": "watch changes in release mode then run.",
    "tasks": [
      {
        "action": "cmd",
        "exe": "nake",
        "options": "release {appName}",
        "next": [
          {
            "action": "cmd",
            "exe": "{releaseBinDir}::app {appName} {appID} &",
            "onPlatform": {
              "windows": {
                "exe": "start {releaseBinDir}::app.exe {appName} {appID}"
              }
            },
            "next": [
              {
                "action": "watch",
                "list": [
                  {
                    "dirs": [
                      "{srcDir}"
                    ],
                    "pattern": "(?=.*).+\\.nim$",
                    "events": [
                      {
                        "action": [
                          "onModified",
                          "onCreated"
                        ],
                        "list": [
                          {
                            "action": "cmd",
                            "exe": "killall app {appName} {appID}",
                            "onPlatform": {
                              "windows": {
                                "exe": "taskkill /IM \"app.exe {appName} {appID}\" /F"
                              }
                            }
                          },
                          {
                            "action": "cmd",
                            "exe": "nake",
                            "options": "compile-release {appName}",
                            "next": [
                              {
                                "action": "cmd",
                                "exe": "{releaseBinDir}::app {appName} {appID} &",
                                "onPlatform": {
                                  "windows": {
                                    "exe": "start {releaseBinDir}::app.exe {appName} {appID}"
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}
